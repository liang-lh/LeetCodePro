[Final solution code after completing Steps 7-8-9]