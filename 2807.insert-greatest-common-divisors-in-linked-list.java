[Complete solution code implementing the algorithm, properly formatted according to the provided template, as a direct string value]