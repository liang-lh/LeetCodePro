Implement your complete, executable solution that handles all identified edge cases. The code must be ready to run without any modifications, placeholders, or TODO comments. It must fit within the provided template structure and correctly solve the problem for all test cases you verified in your reasoning.